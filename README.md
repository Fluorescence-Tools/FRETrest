# FRETrest
FRETrest is a set of helper scripts for generating FRET-restraints for Molecular Dynamics (MD) simulations performed with [AMBER] Software Suite. FRETrest saves restraints in DISANG format, which is also used by AMBER Software Suite for NMR-based restraints (see section 25.1 of [AMBER manual]).
FRETrest implements FRET restraints for implicit dyes represented by pseudo atoms. Each pseudo atom represents the statistical mean position of the fluorescent dye as determined by Accessible Volume simulations ([Kalinin2012], [LabelLib]). These pseudo atoms are restrained with respect to the backbone atoms of the labeled residue and, optionally, adjacent residues. FRETrest can be used to incorporate experimental data obtained from different types of FRET experiments ([Kalinin2012], [Dimura2016]) with various organic dyes and linkers. For MD simulations with explicit (as opposed to implicit) dyes see section 3.10 of [AMBER manual].

Adding FRET restraints to an MD simulation, takes two steps: (1) add pseudo atoms to the topology file, (2) tether pseudo atoms to the corresponding backbone residues and apply FRET restraints between pseudo atoms. These two steps are performed by two scripts: [placeAVmp.py](placeAVmp.py) and [FRETrest.py](FRETrest.py) correspondingly.

First, this command will add dummy atoms to a PDB file of T4 lysozyme protein (PDB ID 148L) and save it to `148l_PA.pdb`:
```
python3 placeAVmp.py -p 148l_noH.pdb -o 148l_PA.pdb -j t4l.fps.json --chi2 'C3 χ²'
```
For the script to work, an input PDB file (`148l_noH.pdb`) and a FRET configuration file (`t4l.fps.json`) must be provided. FRET configuration file can be generated by Olga software [arXiv:1909.02148]. `C3 χ²` is the name of the relevant χ² evaluator from `t4l.fps.json`. Labeling positions, that are present in the `t4l.fps.json`, but are not relevant to the specified χ² will be omitted from the resulting PDB.

Second, this command will generate the AMBER restraint (DISANG) file:
```
python3 FRETrest.py \
  -t 148l_watio_hmr.prmtop \
  -r Equil/26_md_nvt_red_pme_11.restrt \
  -j t4l.fps.json --chi2 'C3 χ²' \
  --fout prod_0001.f --restout prod_0000.restrt \
  --force 50 --resoffset -1
```
It will also generate an updated restart file, so that if there are any inconsistencies between the conformation of the macromolecule and dummy atom positions, positions of the dummy atoms are adjusted accordingly.
Here `148l_watio_hmr.prmtop` is an AMBER topology file, `26_md_nvt_red_pme_11.restrt` is an input restart file, `prod_0001.f` is the path to the resulting restraints file, `prod_0000.restrt` is the path to the resulting adjusted restart file. `--force 50` stands for the maximum inter-dummy force of 50 piconewtons. ` --resoffset -1` option should be provided if the residue numbering in `t4l.fps.json` is shifted by one residue compared to the `.prmtop` file. This can happen if e.g. residue numbering starts from "1" in the `t4l.fps.json`, but in the `.prmtop` it starts from "0", as is usual. The offset can be any integer number, positive or negative.

Comprehensive step by step usage examples are available at [examples/T4L/t4l.sh](examples/T4L/t4l.sh) and [examples/hGBP1/hGBP1.sh](examples/hGBP1/hGBP1.sh). To use the scripts you would need a working installation of [AmberTools], and python libraries [LabelLib] and [mdtraj].

FRETrest was introduced in soon to be published work, which is also available as a preprint ([arXiv:1909.02148]).

[AMBER manual]: http://ambermd.org/doc12/Amber18.pdf
[AmberTools]: http://ambermd.org/GetAmber.php#ambertools
[LabelLib]: https://github.com/Fluorescence-Tools/labellib
[mdtraj]: http://mdtraj.org
[arXiv:1909.02148]: https://arxiv.org/abs/1909.02148
[Kalinin2012]: https://www.nature.com/articles/nmeth.2222
[Dimura2016]: https://doi.org/10.1016/j.sbi.2016.11.012
[AMBER]: http://ambermd.org/
